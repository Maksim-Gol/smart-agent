Студент - Голубев Максим 
Куратор - Виталий Цуриков

## Цель и результат

**Цель:** создать систему, которая позволяет: загрузить смарт-контракт → выполнить статический и LLM-анализ → сгенерировать сценарии атак → провести симуляцию (Foundry/Anvil для Ethereum, TON sandbox) → сформировать отчёт (JSON + PDF) с приоритизацией рисков.

**Пользователь:** аудиторы и разработчики, которым нужен быстрый pre-audit triage.

**Вне области:** мониторинг продакшн-сетей и формальная верификация (можно обозначить как future work).

---

## Архитектура

**Агенты (LangGraph):**

1. Analyzer — статический анализ (Slither/solc-ast) + LLM + RAG по базе уязвимостей (SWC, SmartBugs, отчёты аудиторов).
2. Exploit Planner — генерирует сценарии атак (Foundry / TON sandbox).
3. Simulator — выполняет сценарии, снимает метрики (баланс атакующего, трассы, газ).
4. Reporter — формирует JSON и PDF-отчёт.

**Данные:** SWC Registry, SmartBugs, Damn Vulnerable DeFi/Ethernaut, отчёты аудиторов; для TON — контракты из Tact/FunC-репозиториев и синтетические данные.

**Модели:** сначала линейные и бустинги, затем LLM + RAG. Хранилище — Qdrant.

**Сервис:** CLI + FastAPI; простой UI (Streamlit/Next.js позже).

**Метрики:**

* Precision/Recall/F1 по SWC-классам, mAP@k/NDCG@k по приоритизации.
* Exploit Confirm Rate, TTE (время до PoC).
* p95 latency, стабильность, процент успешно завершённых пайплайнов.

---

## До середины сентября — выбор темы

Описание темы, цели, рисков и источников данных.

---

## Конец сентября — 1-й чекпоинт (установочный)

---

## 20-е числа октября — 2-й чекпоинт (разведочный анализ / EDA)

**Что показать:**

* EDA по датасетам (распределение SWC-классов, версии компилятора, длины и дубликаты).
* Бейзлайны без ML: статический анализ (Slither), скоринг по эвристикам.
* Прототип RAG: Qdrant + SWC/SmartBugs, промпт-шаблоны для LLM.

**Критерии:** ноутбук/скрипт EDA + отчёт; CLI-команда `analyze --static` возвращает JSON с top-risks.

---

## Конец ноября — 3-й чекпоинт (линейные ML-модели)

**Что показать:**

* Фичи: AST/CFG статистика, токен-н-граммы, бинарные признаки Slither.
* Модели: Logistic Regression / Linear SVM для multi-label SWC-классов.
* Отчёт по метрикам, сравнение с эвристиками.

**Критерии:** модель превосходит бейзлайны по macro-F1, есть интерпретация признаков.

---

## Середина января — 4-й чекпоинт (нелинейные ML-модели)

**Что показать:**

* XGBoost/LightGBM на тех же фичах.
* GNN или CodeBERT/GraphCodeBERT как feature extractor.
* Ошибкоанализ по SWC-классам.

**Критерии:** улучшение метрик на 5–10% по сравнению с ноябрём.

---

## Конец января — промежуточная защита

Презентация архитектуры агентов, метрик, сравнений.
Живое демо: анализ контракта → генерация атаки → отчёт.

---

## Середина февраля — 5-й чекпоинт (сервис)

**Что показать:**

* FastAPI endpoints: `/analyze`, `/simulate`, `/report/{id}`.
* Очередь задач (RQ/Celery) для симуляций.
* UI (Streamlit): загрузка контракта, прогресс, отчёт.

**Инфраструктура:** Docker-compose (api + qdrant + worker + postgres), логи и метрики.

**Критерии:** локальный стенд поднимается одной командой; end-to-end сценарий работает.

---

## Конец марта – начало апреля — 6-й чекпоинт (DL)

**Что показать:**

* LLM-агент (Qwen-Coder / DeepSeek-Coder) с RAG.
* Exploit Planner: генерация тестов (Foundry / TON).
* Автоматическая верификация атак в песочнице.

**Критерии:** рост Exploit Confirm Rate на контрольных кейсах.

---

## Середина мая — 7-й чекпоинт (улучшение моделей и сервиса)

**Что показать:**

* Тюнинг LLM (RAG top-k, фильтры, слайсинг AST).
* LoRA-дообучение на синтетических контрактах.
* Генератор синтетических примеров для расширения датасета.
* Улучшенный UX (сравнение запусков, PDF-экспорт).
* Полная документация и reproducibility checklist.

**Критерии:** улучшение mAP/NDCG, стабильная работа пайплайна.

---

## Июнь — защита

* Репозиторий с релизом, docker-образы, демо-видео.
* Пример анализа двух контрактов (Ethereum и TON).
* PDF-отчёт с аналитикой и результатами симуляций.
* Раздел «Ограничения и дальнейшие направления» (Certora, on-chain мониторинг).

---

## Оценивание и бенчмарки

**Datasets:** SWC/SmartBugs, Ethernaut/Damn Vulnerable DeFi, TON-контракты и синтетика.
**Split:** по проектам, чтобы избежать утечек.
**Метрики:** macro/micro-F1, mAP@5, NDCG@5, Exploit Confirm Rate, время анализа.

---

## Основные риски

* Нехватка TON-данных → синтетика + ручная разметка.
* Галлюцинации LLM → строгий RAG и симуляция.
* Проблемы сборки окружения → docker-compose и фиксированные версии инструментов.
* Дисбаланс классов SWC → oversampling и macro-метрики.

---

## Технический стек

* Оркестрация: LangGraph.
* LLM: Qwen2.5-Coder / DeepSeek-Coder.
* RAG: Qdrant + LangChain retrievers.
* Анализ/симуляция: Slither, Foundry (forge/anvil), TON executor/sandbox.
* API/UI: FastAPI, Streamlit.
* Документация и отчёты: Pydantic + WeasyPrint/LaTeX.

---
